databaseChangeLog:
  #- changeSet:
  #    id: create enum type for object rating
  #    author: Luke
  #    changes:
  #      - sql:
  #          sql: create type object_type_enum as ENUM ('FILM', 'PERSON');

  - changeSet:
      id: rating table creation
      author: Luke (generated)
      changes:
        - createTable:
            columns:
              - column:
                  constraints:
                    primaryKey: true
                  name: id
                  type: int
              - column:
                  name: creation_date
                  type: date
              - column:
                  name: modification_date
                  type: date
              - column:
                  constraints:
                    nullable: false
                  name: object_type
                  type: varchar(30)
              - column:
                  constraints:
                    nullable: false
                  name: object_id
                  type: int
              - column:
                  name: rating
                  type: int
              - column:
                  name: user
                  type: int
            tableName: OBJECT_RATING
  - changeSet:
      id: rating auto increment
      author: Luke
      changes:
        - addAutoIncrement:
            columnDataType: int
            columnName: id
            startWith: 1
            tableName: OBJECT_RATING
  - changeSet:
      id: rating_user_fk
      author: lucaskos
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: user
            baseTableName: OBJECT_RATING
            constraintName: fk_user_rating_id
            onDelete: CASCADE
            onUpdate: RESTRICT
            referencedColumnNames: id
            referencedTableName: users
#- changeSet:
#    id: 1542224623996-23
#    author: Luke (generated)
#    changes:
#      - createIndex:
#          columns:
#            - column:
#                name: film
#          indexName: rating_films_film_FILM_ID_fk
#          tableName: OBJECT_RATING
#
#- changeSet:
#    id: 1542224623996-24
#    author: Luke (generated)
#    changes:
#      - createIndex:
#          columns:
#            - column:
#                name: person
#          indexName: rating_films_person_PERSON_ID_fk
#          tableName: OBJECT_RATING
#- changeSet:
#    id: rating for film
#    author: Luke (generated)
#    changes:
#      - addForeignKeyConstraint:
#          baseColumnNames: film
#          baseTableName: OBJECT_RATING
#          constraintName: rating_films_film_FILM_ID_fk
#          deferrable: false
#          initiallyDeferred: false
#          onDelete: no action
#          onUpdate: no action
#          referencedColumnNames: id
#          referencedTableName: FILM
#          validate: true
#- changeSet:
#    id: rating for person
#    author: Luke (generated)
#    changes:
#      - addForeignKeyConstraint:
#          baseColumnNames: person
#          baseTableName: rating_film
#          constraintName: rating_films_person_PERSON_ID_fk
#          deferrable: false
#          initiallyDeferred: false
#          onDelete: no action
#          onUpdate: no action
#          referencedColumnNames: id
#          referencedTableName: person
#          validate: true